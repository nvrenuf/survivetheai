---
import Layout from '../layouts/BaseLayout.astro';
import PostGrid from '../components/PostGrid.astro';
import { getCollection } from 'astro:content';
import type { Post } from '../data/Posts';

function chunkArray<T>(arr: T[], size: number): T[][] {
  const result: T[][] = [];
  for (let i = 0; i < arr.length; i += size) {
    result.push(arr.slice(i, i + size));
  }
  return result;
}

const posts: Post[] = await getCollection('posts');
posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
const groupedItems = chunkArray(posts, 5);
---

<Layout>
  <main class="bg-neutral-950 py-20">
    <div class="mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
      <div class="mb-10 space-y-3">
        <p class="text-xs font-semibold uppercase tracking-[0.3em] text-neutral-500">Blog</p>
        <h1 class="text-3xl font-extrabold text-neutral-50 sm:text-4xl">Latest posts</h1>
        <p class="text-neutral-400">Newest to oldest, refreshed automatically from the posts collection.</p>
      </div>
      <PostGrid groupedItems={groupedItems} />
    </div>
  </main>
</Layout>
